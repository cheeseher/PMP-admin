# 机器人管理

## 页面功能
管理 Telegram 机器人配置，支持传统机器人和客户端账号两种类型。

## 字段说明

### 列表字段
| 字段名 | 字段含义 | 是否必填 | 交互类型 | 说明 |
|--------|----------|----------|----------|------|
| 序号 | 数据序号 | 否 | 文本显示 | 自动编号 |
| 机器人名称 | 机器人显示名称 | 是 | 文本显示 | 用户自定义名称 |
| Bot 用户名 | Telegram 机器人用户名 | 否 | 文本显示 | @开头的用户名，客户端账号显示为空 |
| 机器人类型 | 机器人类型 | 是 | 标签显示 | bot-机器人，client-客户端账号 |
| 配对令牌 | 客户端配对令牌 | 否 | 文本显示 | 客户端账号生成的唯一配对令牌 |
| 状态 | 机器人状态 | 是 | 标签显示 | enabled-开启，disabled-关闭 |
| 配对状态 | 客户端配对状态 | 是 | 标签显示 | unpaired-未配对，paired-已配对 |
| 创建人 | 创建者 | 是 | 文本显示 | 创建账号 |
| 创建时间 | 创建时间 | 是 | 文本显示 | 格式化时间 |

### 筛选项
| 字段名 | 字段含义 | 交互类型 | 说明 |
|--------|----------|----------|------|
| 机器人名称 | 机器人名称筛选 | 模糊搜索 | 输入框，支持模糊匹配 |
| 状态 | 状态筛选 | 精准匹配 | 下拉选择：全部、开启、关闭 |
| 配对状态 | 配对状态筛选 | 精准匹配 | 下拉选择：全部、未配对、已配对 |

### 新增/编辑表单
| 字段名 | 字段含义 | 是否必填 | 交互类型 | 说明 |
|--------|----------|----------|----------|------|
| 机器人类型 | 机器人类型 | 是 | 单选按钮 | add模式显示：机器人、客户端账号 |
| 机器人名称 | 机器人显示名称 | 是 | 文本输入 | 2-50个字符 |
| Bot Token | 机器人令牌 | 是* | 文本输入 | 仅机器人类型必填 |
| Bot 用户名 | 机器人用户名 | 是* | 文本输入 | 仅机器人类型必填，必须以bot结尾 |
| 状态 | 机器人状态 | 是* | 开关 | 仅机器人类型显示 |

*注：带*字段仅在机器人类型时必填

## 交互逻辑

### 新增机器人
1. 点击"新增机器人"按钮打开弹窗
2. 选择机器人类型（机器人/客户端账号）
3. 填写相应字段：
   - 机器人类型：填写名称、Token、用户名、状态
   - 客户端账号类型：仅填写名称
4. 点击保存：
   - 机器人：正常创建，状态为开启/关闭
   - 客户端账号：生成唯一配对令牌，状态为开启/关闭（默认开启），配对状态为“未配对”
5. 成功后显示提示信息，列表刷新

### 编辑机器人
1. 点击编辑按钮打开弹窗
2. 机器人类型：只能编辑名称和状态
3. 客户端账号类型：只能编辑名称；已配对时显示“取消配对”按钮，确认后立即将配对状态改为“未配对”并清空配对令牌（无需再次保存）
4. 保存后更新列表数据

### 状态切换
1. 仅机器人类型支持状态切换
2. 点击状态按钮弹出确认框
3. 确认后更新状态

### 删除机器人
1. 点击删除按钮弹出确认框
2. 确认后从列表中移除
3. 显示删除成功提示

## 特殊逻辑

### 配对令牌生成
- 客户端账号创建时自动生成
- 格式：随机字符串_pmp_client_token_随机字符串
- 示例：f7b3k9c1a_pmp_client_token_d4g6h2j8
- 用于客户端与系统配对连接

### 状态管理
- 机器人：enabled（开启）、disabled（关闭）
- 客户端账号：enabled（开启）、disabled（关闭）
- 不同状态显示不同颜色标签

### 配对状态管理
- 未配对（unpaired）：客户端账号创建后的初始状态，显示橙色标签
- 已配对（paired）：客户端成功配对，显示绿色标签
- 仅客户端账号类型显示配对状态，机器人账号不显示配对状态

### 表单验证
- 机器人类型切换时动态调整验证规则
- 客户端账号隐藏Token和用户名验证
- 实时显示错误提示