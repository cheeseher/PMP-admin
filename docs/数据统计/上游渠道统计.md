# 思方支付管理系统 - 上游渠道统计

## 业务目标

建立上游渠道交易数据统计分析体系，通过对上游渠道的交易金额、通道成本、入账金额和交易笔数等核心指标进行统计分析，实现对上游渠道性能和成本效益的全面评估，为渠道选择和资源配置优化提供数据支持，同时帮助平台了解各上游渠道的运行状况和盈利能力。

## 业务逻辑

### 数据筛选逻辑

**时间维度筛选**:
- 支持多种时间范围快速筛选：今日、昨日、最近7天
- 支持自定义日期范围，实现精确的时间段统计分析
- 默认采用"今日"数据，确保关注最新渠道使用状况

**渠道筛选**:
- 支持按供应商ID进行精确查询，快速定位特定上游渠道
- 可针对单个或多个上游渠道进行数据统计与分析

**商户维度筛选**:
- 支持多选方式筛选特定商户通过上游渠道处理的交易
- 可同时分析多个商户对同一上游渠道的使用情况
- 不选择商户时默认展示所有商户的上游渠道使用数据

### 核心统计指标

**金额指标**:
- 总成功金额：通过上游渠道成功处理的交易金额总和，反映渠道业务规模
- 总上游通道成本：向上游渠道支付的成本费用总额
- 总上游入账金额：扣除通道成本后的实际入账金额总和

**交易量指标**:
- 总成功单数：上游渠道成功处理的交易笔数
- 总笔数：上游渠道接收的所有交易请求笔数（包含失败交易）
- 成功率：成功交易笔数占总交易笔数的百分比

### 数据展示与分析

**汇总统计**:
- 在页面顶部展示关键指标汇总数据，提供整体上游渠道表现概览
- 汇总数据随筛选条件变化而动态更新，确保数据一致性

**明细数据**:
- 以表格形式展示各上游渠道的详细统计数据
- 每行独立展示上游渠道的成功金额、通道成本、入账金额、交易笔数和成功率
- 支持对不同上游渠道的数据进行对比分析

### 数据导出功能

- 支持将符合当前筛选条件的上游渠道统计数据导出为Excel文件
- 导出数据包含所有显示在页面上的核心指标
- 导出文件包含查询条件信息，便于后续分析使用

## 业务规则与应用场景

### 渠道性能分析

**交易处理能力评估**:
- 通过交易笔数和成功率分析各上游渠道的处理能力
- 发现高性能的上游渠道，优先分配更多交易量
- 识别低性能上游渠道，分析原因并制定改进策略

**成功率监控**:
- 跟踪分析各上游渠道的交易成功率
- 对成功率低于阈值（如95%）的渠道进行重点关注
- 发现并解决影响渠道成功率的技术或业务问题

### 成本效益分析

**通道成本评估**:
- 分析各上游渠道的成本结构和成本水平
- 计算每笔交易的平均成本，识别高成本和低成本渠道
- 评估成本与交易量、成功率之间的关系

**盈利能力分析**:
- 计算通过各上游渠道处理交易的利润贡献
- 评估不同交易类型在不同渠道的盈利差异
- 为渠道选择和资源配置提供盈利视角的决策支持

### 渠道优化策略

**交易路由优化**:
- 基于成本、成功率和处理能力数据优化交易路由策略
- 制定不同交易类型的最优渠道选择方案
- 实现成本最小化和成功率最大化的平衡

**渠道容量规划**:
- 分析各渠道的交易峰值和容量限制
- 根据交易预测调整渠道资源配置
- 确保系统在高峰期仍能保持稳定运行

## 权限控制

- 查看权限：具有"数据统计/上游渠道统计查看"权限的角色可访问上游渠道统计数据
- 导出权限：需要"数据统计/导出"特殊权限才能导出上游渠道统计数据
- 数据范围权限：
  - 系统管理员可查看所有上游渠道的完整数据
  - 财务人员可查看与成本和结算相关的上游渠道数据
  - 运营人员可查看与交易量和成功率相关的性能数据

## 扩展功能

### 趋势分析

- 提供上游渠道使用趋势的图表展示
- 支持按日、周、月等不同周期查看趋势变化
- 对比分析不同时期的渠道表现，发现业务规律

### 异常监控与预警

- 设置上游渠道成功率和交易量的预警阈值
- 当渠道数据出现异常波动时自动报警
- 支持对重点渠道进行实时监控，确保业务稳定

### 渠道健康评分

- 基于成功率、成本效益、响应时间等维度构建渠道健康评分体系
- 提供上游渠道的综合性能评级
- 为渠道管理和优化提供量化依据 