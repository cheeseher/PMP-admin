# 四方管理后台（原型）

> 本仓库用于快速验证机器人管理后台的交互流程与主要页面布局，所有数据为前端模拟，便于 UI/交互评审。

## 模块概览
- 机器人管理
  - 指令管理（已完成）
  - 操作记录（已完成）
  - 群组管理（已完成基础）
- 数据清理
- 商户管理
  - 商户列表（已完成：新增"钱包地址"字段与筛选）

## 订单管理
- 商户订单管理（已完成：筛选区布局优化）
  - 筛选布局：采用流式 flex 排布（自动换行），行间距 `8px`、列间距 `12px`
  - 控件宽度：下拉统一 `168px`，整体排版更紧凑，避免筛选项独占一行
- 商户提现审核（已完成：新增提现审核页面）
  - 筛选功能：商户名称、提现单号、状态（未确认/成功/失败）、申请时间
  - 表格字段：商户名称、提现订单号、提现数量（U）、类型、钱包地址、提现金额（CNY）、备注、审核备注、状态、操作时间
  - 操作功能：审核、批量审核、导出（导出按钮位于批量审核右侧）
  - 操作规则：仅“未确认”状态可操作；拒绝在审核弹窗选择并填写备注；操作列仅保留【审核】按钮
  - 备注展示：根据行数据动态生成固定模板文案，含商户名称、数量*汇率、RMB金额与地址
  - 审核弹窗：显示提现详情，支持通过/拒绝审核，输入审核备注
  - 展示修复：类型列统一显示 `TRX`（当前仅支持 TRX）
  - 订单号格式：`MTX` + `yyyyMMddHHmmss` + 6位随机数字（示例：`MTX20251112153045123456`）

## 指令管理
- 支持“默认指令”“拉人指令”等标签页，包含基本的增删改查交互。
- 已在“拉人指令”页添加示例数据：
 - 已在"预设指令"中添加序号17的"下发"指令：
   - 指令格式：`下发#金额#汇率`
   - 指令名称：下发
 - 已在"拉人指令"页添加示例数据：
   - 指令名称：拉人一
   - 回复内容：`/add @shane @dylan @pmpbot`

## 操作记录
- 展示用户在群内的指令交互记录，支持筛选与分页。
- 新增筛选项：关联类型（机器人/普通账号）
  - 选项：全部、机器人、普通账号
  - 宽度：`168px`
  - 作用：按记录中“关联机器人”字段的类型过滤（机器人为非纯数字，普通账号为纯数字ID）。
- 示例展示：当 `botInvolved` 为 `621152047` 时，列表显示为“普通账号A”。
- 示例调整：将拉人指令示例的“机器人反馈”文案清空（对应该条记录的反馈字段置空）。
- 现有筛选项：关联机器人、群组、日期范围、用户与命令关键字。

## 机器人管理
- 普通账号列表新增字段：`TGID`
  - 展示位置：位于 `名称` 后、`手机号` 前
  - 字段属性：只读，登录后自动识别与填充
  - 表单策略：新增与编辑弹窗中不包含 `TGID` 字段
- 界面优化：移除“普通账号”列表中的“状态”列和操作列中的“编辑”按钮。
- 表单优化：新增与编辑弹窗中移除“状态”字段，新增时默认为启用状态。

## 数据清理
- 页面职责：定期清理系统中的历史数据、日志等，以保持系统性能。支持按时间范围或保留天数清理商户订单、结算单和操作日志，并可按状态进行筛选。

## 商户管理
- 商户列表页面新增字段：`钱包地址`
  - 表格列：新增展示列 `钱包地址`
  - 筛选区：新增输入框 `钱包地址`（模糊匹配），宽度统一 `168px`
  - 新增/编辑弹窗：在 `商户号` 下方增加 `商户钱包地址` 字段，非必填

## 预览
- 本地开发：`npm run dev`
- 访问路径：`/bot/operation-log` 查看操作记录；`/bot/command-management` 查看指令管理；`/bot/bot-management` 查看机器人与普通账号列表
 - 商户管理入口：`/product/list` 查看商户列表（含“钱包地址”筛选与列）
 - 资金管理入口：`/audit/merchant-fund` 查看商户资金流水（含"下发"交易类型）

## 当前原型设计状态
- 指令管理：列表、表单、验证与示例数据（完成）
- 操作记录：列表、筛选（含关联类型）、分页与示例数据（完成）
- 群组管理：基础列表与筛选（完成基础）
- 机器人管理：普通账号列表新增 `TGID` 字段（完成）
 - 商户管理：商户列表新增 `钱包地址` 字段与筛选（完成）

## 资金管理
- 商户资金流水页面新增交易类型：`下发`
  - 交易类型筛选器：新增选项 `下发`
  - 模拟数据：在表格第一条新增"下发"交易类型记录，交易金额为 -500.00，手续费 5.00
  - 页面路径：`/audit/merchant-fund`

## 说明
- 本原型仅用于评审与交互验证，后续接入真实后端时需替换为接口数据与服务端校验。
 - 支持"默认指令""拉人指令"等标签页，包含基本的增删改查交互。
 - 已在"预设指令"中添加序号17的"下发"指令：
   - 指令格式：`下发#金额#汇率`
   - 指令名称：下发
   - 指令格式：`下发#金额*汇率`
