# 思方支付管理系统 - 供应商管理

## 业务目标

构建完整的供应商管理体系，有效管理上游支付渠道，确保系统能够通过多种支付供应商进行资金交易，并对供应商的资金、接口配置和状态进行高效管理，为整个支付系统提供稳定可靠的上游通道支持。

## 业务逻辑

### 供应商查询逻辑

**查询条件**:
- 供应商ID：精确匹配供应商唯一标识
- 上游通道名称：模糊匹配供应商展示名称
- 上游通道编码：模糊匹配供应商业务编码
- 状态：筛选启用/禁用状态的供应商

### 供应商基础信息管理

**必填信息**:
- 上游通道名称：支付供应商的名称标识
- 上游通道编码：系统内识别供应商的唯一编码
- 上游通道商户号：在供应商平台注册的商户标识
- 网关地址：供应商API接口地址
- 异步通知网址：接收供应商支付结果通知的系统回调地址

**选填信息**:
- API密钥：与供应商进行API通信的密钥
- 应用APPID：供应商平台分配的应用标识
- 安全密钥：用于数据交互加密的密钥
- 商户私钥：用于签名的私钥信息
- 平台公钥：验证供应商签名的公钥
- 页面跳转网址：支付完成后的前端跳转地址
- 回调白名单：允许接收回调的IP地址列表
- 备注：其他需要说明的信息

### 供应商资金管理

**资金状态**:
- 余额：供应商账户当前可用金额
- 冻结金额：暂时被冻结不可用的资金
- 提醒阈值：当余额低于此值时系统发出预警

**资金操作**:
- 增加余额：为供应商账户增加资金
- 减少余额：从供应商账户扣减资金
- 余额解冻：将冻结资金恢复为可用余额

**资金操作约束**:
- 减少余额时不得超过当前可用余额
- 解冻金额不得超过当前冻结金额
- 资金操作需记录操作人和操作备注，用于审计

### 供应商状态管理

- 启用/禁用切换：控制供应商是否参与交易
- 状态变更确认：变更状态前需二次确认，防止误操作
- 状态影响：禁用状态的供应商不参与交易路由

### 数据导出功能

- 支持将符合当前筛选条件的供应商数据导出
- 导出数据包含供应商基本信息、资金状态等关键信息

## 业务规则与约束

### 供应商唯一性

- 系统内供应商编码必须唯一，不允许重复
- 同一供应商的不同支付方式通过通道编码区分

### 资金安全规则

- 资金操作必须有明确的业务理由和备注
- 大额资金变动可能需要多级审批
- 资金变动历史需完整记录，支持审计追溯

### 接口配置安全

- 密钥类信息需加密存储
- 接口参数变更可能影响交易处理，需谨慎操作
- 回调白名单限制有效提高接口安全性

### 余额与提醒阈值

- 余额不足会影响交易成功率
- 低于提醒阈值时系统应发出警告
- 默认提醒阈值为5000元，可根据业务量调整

## 特殊功能

### 余额解冻机制

**解冻流程**:
- 选择需解冻的供应商账户
- 设置解冻金额（不得超过当前冻结总额）
- 提供解冻理由
- 执行解冻操作（冻结金额减少，可用余额增加）

**解冻使用场景**:
- 交易风控冻结后的解除
- 临时资金冻结到期释放
- 特殊业务场景下的资金解冻

## 权限控制

- 查看权限：具有"供应商管理/查看"权限的角色可访问供应商列表
- 操作权限：
  - 新增供应商：需要"供应商管理/新增"权限
  - 编辑供应商：需要"供应商管理/编辑"权限
  - 删除供应商：需要"供应商管理/删除"权限
  - 资金操作：需要"供应商管理/资金"特殊权限
- 数据范围权限：管理员可能被限制只能查看和管理特定范围的供应商 