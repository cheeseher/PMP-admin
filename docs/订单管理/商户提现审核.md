# 思方支付管理系统 - 商户提现审核

## 业务目标

提供商户提现申请的管理功能，支持管理员对提现请求进行审核、批准或拒绝，并记录完整的审核流程，确保商户资金安全合规提现。

## 业务逻辑

### 提现申请查询

**时间筛选**:
- 支持按日期范围筛选提现记录
- 提供常用时间段快捷选项：今天、昨天、最近7天、最近30天、本月、上月

**订单标识筛选**:
- 提现单号：系统生成的唯一提现交易标识

**状态筛选**:
- 未确认(PENDING)：提现已申请但尚未审核
- 成功(PAID)：提现已审核通过并完成打款
- 失败(FAILED)：提现审核拒绝或打款失败

### 提现金额处理

**余额计算逻辑**:
```
提现后余额 = 提现前余额 - 提现金额 - 手续费
```

**手续费计算**:
```
手续费 = 提现金额 × 手续费率
```
*注：手续费率根据商户等级和提现金额有所不同*

**冻结资金处理**:
- 提现时可以同步调整冻结资金金额
- 冻结资金变更逻辑：
  ```
  提现后冻结 = 用户手动设置的新冻结金额
  ```
- 正常情况下，冻结资金会随提现减少：
  ```
  提现后冻结 = 提现前冻结 - 提现金额（如果提现金额来自冻结部分）
  ```

### 提现审核流程

**状态流转**:
- 初始状态：未确认(PENDING)
- 审核通过：成功(PAID)
- 审核拒绝：失败(FAILED)

**审核操作**:
1. **通过审核**：
   - 确认提现信息无误后，管理员批准提现申请
   - 系统更新商户余额和冻结金额
   - 标记提现记录为"成功"状态
   - 记录审核通过意见和操作人

2. **拒绝审核**：
   - 管理员拒绝提现申请
   - 系统退回提现金额到商户账户
   - 标记提现记录为"失败"状态
   - 必须记录拒绝原因和操作人

**审核规则**:
- 只有"未确认"状态的提现申请可以进行审核
- 审核意见不能少于5个字符
- 审核操作必须进行身份验证
- 所有审核操作都需要记录操作日志

### 批量审核功能

**批量审核规则**:
- 支持选择多条符合条件的提现申请进行批量审核
- 批量审核必须确保所有选中记录都是"未确认"状态
- 批量通过/拒绝时必须填写统一的审核意见
- 批量操作需要二次确认

### 提现详情查看

**详情内容**:
- 提现单号
- 商户信息
- 提现金额
- 手续费
- 提现状态
- 备注信息

## 数据导出逻辑

- 支持将当前筛选条件下的提现记录导出为Excel文件
- 导出内容包括表格中显示的全部字段
- 导出文件命名规则：商户提现记录_YYYYMMDD_HHMMSS.xlsx

## 权限控制

- 查看权限：具有"提现管理/查看"权限的角色可访问列表
- 审核权限：具有"提现管理/审核"权限的角色可执行审核操作
- 高级权限：
  - 单笔审核：需要"提现管理/单笔审核"权限
  - 批量审核：需要"提现管理/批量审核"权限（权限级别更高）
- 金额限制：根据管理员级别设置不同的审核金额上限 