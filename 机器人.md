# Telegram 机器人后台功能页面结构草稿（新版）

## 1. 指令管理

**页面功能：**

* 支持多机器人指令配置：每个 Bot 可以拥有独立的指令集
* 配置平台支持的所有机器人指令（内置与自定义）
* 配置平台支持的所有机器人指令（内置与自定义）
* 设置每条指令的关键词、参数格式、说明文案、是否启用
* 配置指令是否为“动态指令”，用于根据绑定身份生成差异化响应内容

**页面结构：**

* 表格字段：

  * 指令关键词（如：ye）
  * 示例格式（如：ye#商户名）
  * 所属机器人（选择一个 bot）
  * 分类（查询类 / 操作类 / 动态类 / 绑定类等）
  * 是否启用
  * 操作列：编辑 / 删除

* 操作按钮：新增指令（弹窗）

**新增 / 编辑指令弹窗字段：**

* 所属机器人（必填，下拉选择 bot 名称）
* 指令关键词（必填）
* 示例格式（说明展示用途）
* 指令分类（下拉选：查询类 / 操作类 / 动态响应类）
* 响应模板（支持 Mustache / 变量替换语法）

  * 示例：

  ```
  您当前配置的支付产品如下：
  {{#each products}}
  - {{name}}（{{code}}）
  {{/each}}
  ```
* 数据来源类型：商户绑定信息 / 商户支付产品 / 商户余额 / 指定接口
* 是否需要绑定身份：是 / 否
* 启用状态：启用 / 停用

---

## 2. 角色管理

**页面功能：**

* 定义 Telegram 群组或用户的功能权限
* 将权限按“角色”划分，并可复用分配

**页面结构：**

* 表格字段：

  * 角色名称（如：财务群 / 运营组）
  * 已授权指令数
  * 授权群组数 / 用户数
  * 操作列：配置权限 / 绑定群组 / 绑定用户 / 删除
* 角色权限配置弹窗：

  * 可选指令列表（多选）
  * 是否需要审批（按指令粒度）

---


## 4. 欢迎语设置

**页面功能：**

* 配置机器人在新成员加入时发送的欢迎语
* 支持变量替换、不同群组使用不同内容

**页面结构：**

* 表格字段：

  * 欢迎语 ID / 名称
  * 适用群组 / 角色
  * 是否启用
  * 是否含按钮 / 菜单
  * 操作列：编辑 / 删除
* 欢迎语编辑区：

  * 文本内容（支持变量，如 {{商户名}}）
  * 附加操作按钮（如“绑定商户”、“获取余额”）

---

## 5. 商户绑定管理

**页面功能：**

* 展示并管理商户与 Telegram 群组 / 用户之间的绑定关系
* 记录绑定指令的执行记录与来源

**页面结构：**

* 表格字段：

  * 商户名称
  * 群组名称 / ID
  * 用户 TG 昵称 / TG ID
  * 来源（指令绑定 / 后台绑定）
  * 绑定时间 / 状态
  * 操作列：解绑 / 查看日志
* 支持手动新增绑定（弹窗）

---

## 6. 指令执行日志

**页面功能：**

* 记录机器人接收到的所有指令执行过程
* 包含解析、操作结果、错误信息、响应时间等

**页面结构：**

* 筛选项：时间范围、执行结果、指令关键词、用户/群组、平台单号
* 表格字段：

  * 指令原文
  * 操作类型
  * 商户 / 渠道
  * 用户 TG ID
  * 群组 ID
  * 执行时间
  * 执行状态
  * 错误提示
  * 操作列：查看详情

---

## 7. 群发任务记录

**页面功能：**

* 管理机器人主动群发账单的记录
* 支持查看失败记录并重发

**页面结构：**

* 表格字段：

  * 群发任务时间
  * 发起人（TG ID）
  * 推送内容预览
  * 推送群组数
  * 成功数 / 失败数
  * 操作列：查看详情 / 补发失败

---

## 8. 操作审批中心（可选）

**页面功能：**

* 审核需要风控确认的敏感操作（如余额调整、修改金额、撤销订单等）

**页面结构：**

* 表格字段：

  * 指令类型
  * 发起人（TG ID）
  * 商户 / 单号
  * 当前状态（待审核 / 已通过 / 已驳回）
  * 操作列：审核 / 拒绝

---

## 9. 机器人管理

**页面功能：**

* 配置 Telegram 机器人接入参数，完成机器人创建与 webhook 对接流程

**页面结构：**

* 配置字段：

  * Bot 名称
  * Bot Token（通过 @BotFather 创建后获得）
  * Webhook 接口地址
  * Webhook 启用状态（启用 / 停用）
  * Bot 说明 / 注释
* 操作说明卡片：

  * 第一步：在 Telegram 中搜索并启动 `@BotFather`
  * 第二步：发送 `/newbot` 创建机器人
  * 第三步：设置机器人名称、用户名（以 bot 结尾）
  * 第四步：复制 BotFather 返回的 Token，粘贴到此后台配置中
  * 第五步：点击“启用 webhook”，系统将自动注册 webhook 接收指令

---

以上为新版 Telegram 机器人后台功能结构草稿，供评审与开发确认。
