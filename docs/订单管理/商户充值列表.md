# 思方支付管理系统 - 商户充值列表

## 业务目标

提供商户账户充值记录管理功能，用于监控和追踪商户账户余额变动情况，支持对充值记录的查询、导出和审核管理。

## 业务逻辑

### 充值记录查询

**时间筛选**:
- 支持按日期范围筛选充值记录
- 提供常用时间段快捷选项：今天、昨天、最近7天、最近30天、本月、上月

**订单标识筛选**:
- 充值订单号：系统生成的唯一充值交易标识

**状态筛选**:
- 未确认：充值已申请但尚未处理完成
- 成功：充值已成功，资金已到账
- 失败：充值操作失败，未增加商户余额

### 账户余额处理

**余额计算逻辑**:
```
充值后余额 = 充值前余额 + 充值金额
```

**冻结资金处理**:
- 支持在充值操作的同时调整冻结资金金额
- 冻结资金不影响充值总额的计算
- 冻结资金变更逻辑：
  ```
  充值后冻结 = 用户手动设置的新冻结金额
  ```
- 冻结资金异常情况：如充值后冻结金额小于原冻结金额，系统应发出警告提示

### 充值审核流程

**充值状态流转**:
- 初始状态：未确认（充值申请已提交）
- 终态：成功（充值已确认，资金已到账）/ 失败（充值被拒绝或操作失败）

**审核规则**:
- 手动充值需要有充值权限的管理员审核
- 审核通过后立即更新商户账户余额
- 审核操作需记录操作人、操作时间和审核结果
- 审核拒绝时需填写拒绝原因

### 充值记录管理

**查看详情**:
- 支持查看单条充值记录的详细信息
- 详情内容包括：
  - 充值订单号
  - 商户ID和名称
  - 充值前余额和冻结金额
  - 充值金额
  - 充值后余额和冻结金额
  - 充值状态
  - 备注信息
  - 操作时间

**数据导出**:
- 支持将符合筛选条件的充值记录导出为Excel文件
- 导出内容包括表格中显示的字段
- 导出文件命名规则：商户充值记录_YYYYMMDD_HHMMSS.xlsx

### 充值操作

**充值表单规则**:
- 商户选择：必填，管理员需从下拉列表中选择商户
- 充值金额：必填，必须为正数
- 充值后冻结：选填，可以在充值同时调整商户的冻结金额
- 备注信息：选填，记录充值原因或其他说明信息

**金额校验规则**:
- 充值金额必须大于0
- 冻结金额不能为负数
- 当调整冻结金额低于原冻结金额时，系统提示可能解冻资金

## 权限控制

- 查看权限：具有"充值管理/查看"权限的角色可查看充值记录
- 充值操作权限：具有"充值管理/操作"权限的角色可执行充值操作
- 审核权限：具有"充值管理/审核"权限的角色可审核充值申请
- 数据范围权限：根据管理员级别限制可操作的商户范围 